#!/bin/sh
## 2025-06-14 SARBS

# Schaltet alle Cronjobs aus/ein.
# Speichert deaktivierte Crontabs in ~/.config/cronsaved fÃ¼r Backup-Zwecke.

CONFIG_DIR="${XDG_CONFIG_HOME:-$HOME/.config}"
CRONSAVED_FILE="$CONFIG_DIR/cronsaved"

# PrÃ¼fen ob Cronjobs aktuell aktiv sind
if crontab -l >/dev/null 2>&1 && [ "$(crontab -l 2>/dev/null | wc -l)" -gt 0 ]; then
    # Cronjobs sind aktiv - deaktivieren und speichern
    crontab -l > "$CRONSAVED_FILE" 2>/dev/null \
        && crontab -r \
        && notify-send "ğŸ•“ Cronjobs gespeichert und deaktiviert." \
        || notify-send "âŒ Fehler beim Deaktivieren der Cronjobs."
elif [ -f "$CRONSAVED_FILE" ]; then
    # Cronjobs sind inaktiv aber Backup existiert - wiederherstellen
    crontab - < "$CRONSAVED_FILE" \
        && notify-send "ğŸ•“ Cronjobs wieder aktiviert." \
        || notify-send "âŒ Fehler beim Aktivieren der Cronjobs."
else
    # Keine aktiven Cronjobs und kein Backup
    notify-send "âš ï¸ Keine Cronjobs gefunden und kein Backup vorhanden."
fi
