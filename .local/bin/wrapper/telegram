#!/bin/sh
## 2025-12-10   SARBS
# Telegram Wrapper mit Theme und Qt-Skalierung

## NOTE Telegramm ist echt ein seltsamer fall!
# Die Skalierung sollte nach dem Dateimanager-Dialog eingestellt werden
# T480 WQHD SCALE_FACTOR=1 manuel setzen
# dann intern über den Prozentregler hochdrehen
# T480 WQHD auf 180% hochdrehen

# Manuelle Skalierung (überschreibt Auto-Erkennung)
SCALE_FACTOR=1

# Lese berechneten Skalierungsfaktor aus State-Datei (falls nicht manuell gesetzt)
# Bei Telegram nutzen wir den manuellen Wert (siehe NOTE oben)
# state_file="${XDG_STATE_HOME:-$HOME/.local/state}/xsession/scale"
# [ -f "$state_file" ] && SCALE_FACTOR=$(cat "$state_file")

# Theme-Update
# TODO Verlinkung fixen. bg sollte auf aktuelles Hintergrundbild zeigen, oder so
walogram -i ~/.local/share/bg >/dev/null 2>&1
# walogram -B -i ~/.local/share/bg >/dev/null 2>&1

# TODO Prüfen auf nutzen...
# THEME_PATH=~/.cache/walogram/wal.tdesktop-theme

# Qt-Skalierung
export QT_SCALE_FACTOR=$SCALE_FACTOR

exec /usr/bin/Telegram "$@"
