#!/bin/sh
## 2025-12-10   SARBS
# Firefox Wrapper - liest SCALE_FACTOR aus State-Datei

# Manuelle Skalierung (überschreibt Auto-Erkennung)
# SCALE_FACTOR=1.5

# Lese berechneten Skalierungsfaktor aus State-Datei (geschrieben von .xprofile)
state_file="${XDG_STATE_HOME:-$HOME/.local/state}/xsession/scale"
[ -f "$state_file" ] && SCALE_FACTOR=$(cat "$state_file")

# Fallback falls State-Datei nicht existiert
SCALE_FACTOR=${SCALE_FACTOR:-1.5}

# NVIDIA Prime Render Offload (auskommentiert = nutze integrierte GPU)
# export __NV_PRIME_RENDER_OFFLOAD=1
# export __GLX_VENDOR_LIBRARY_NAME=nvidia

# Firefox braucht diese Umgebungsvariable
export MOZ_ENABLE_WAYLAND=0
export GDK_SCALE=$SCALE_FACTOR
export GDK_DPI_SCALE=$SCALE_FACTOR

# Alternative: Direkt über about:config
# (aber dann nicht dynamisch)
exec /usr/bin/firefox "$@"
