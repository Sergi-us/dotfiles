#!/bin/sh
## 2025-01-09 SARBS

# Shows the current moon phase with detailed Nerd Font icons.

moonfile="${XDG_DATA_HOME:-$HOME/.local/share}/moonphase"

# Hole Mondtag von wttr.in und mappe auf Icon
if ! [ -s "$moonfile" ] || [ "$(stat -c %y "$moonfile" 2>/dev/null | cut -d' ' -f1)" != "$(date '+%Y-%m-%d')" ]; then
	moonday="$(curl -sf "wttr.in/?format=%M")" || exit 1

	# Mappe Mondtag (0-29) auf Nerd Font Icons
	case "$moonday" in
		0)  icon="" ;;
		1)  icon="" ;;
		2)  icon="" ;;
		3)  icon="" ;;
		4)  icon="" ;;
		5)  icon="" ;;
		6)  icon="" ;;
		7)  icon="" ;;
		8)  icon="" ;;
		9)  icon="" ;;
		10) icon="" ;;
		11) icon="" ;;
		12) icon="" ;;
		13) icon="" ;;
		14) icon="" ;;
		15) icon="" ;;
		16) icon="" ;;
		17) icon="" ;;
		18) icon="" ;;
		19) icon="" ;;
		20) icon="" ;;
		21) icon="" ;;
		22) icon="" ;;
		23) icon="" ;;
		24) icon="" ;;
		25) icon="" ;;
		26) icon="" ;;
		27) icon="" ;;
		28|29) icon="" ;;
		*) exit 1 ;;
	esac

	# Schreibe Icon in Datei
	printf "%s" "$icon" > "$moonfile"
fi

icon="$(cat "$moonfile")"

# Bestimme Name basierend auf Icon
case "$icon" in
	"") name="Neumond" ;;
	"") name="Zunehmende Sichel 1" ;;
	"") name="Zunehmende Sichel 2" ;;
	"") name="Zunehmende Sichel 3" ;;
	"") name="Zunehmende Sichel 4" ;;
	"") name="Zunehmende Sichel 5" ;;
	"") name="Zunehmende Sichel 6" ;;
	"") name="Erstes Viertel" ;;
	"") name="Zunehmender Mond 1" ;;
	"") name="Zunehmender Mond 2" ;;
	"") name="Zunehmender Mond 3" ;;
	"") name="Zunehmender Mond 4" ;;
	"") name="Zunehmender Mond 5" ;;
	"") name="Zunehmender Mond 6" ;;
	"") name="Vollmond" ;;
	"") name="Abnehmender Mond 1" ;;
	"") name="Abnehmender Mond 2" ;;
	"") name="Abnehmender Mond 3" ;;
	"") name="Abnehmender Mond 4" ;;
	"") name="Abnehmender Mond 5" ;;
	"") name="Abnehmender Mond 6" ;;
	"") name="Letztes Viertel" ;;
	"") name="Abnehmende Sichel 1" ;;
	"") name="Abnehmende Sichel 2" ;;
	"") name="Abnehmende Sichel 3" ;;
	"") name="Abnehmende Sichel 4" ;;
	"") name="Abnehmende Sichel 5" ;;
	" ") name="Abnehmende Sichel 6" ;;
	*) name="Unbekannt" ;;
esac

echo "${icon} "

case $BLOCK_BUTTON in
	3) notify-send " Mondphasen Modul" "Zeigt die aktuelle Mondphase an.

Phase: ${name}

28 detaillierte Mondphasen mit Nerd Font Icons" ;;
	6) setsid -f "$TERMINAL" -e "$EDITOR" "$0" ;;
esac

#   uniF0D0; E3C8
#   uniF0D1; E3C9
#   uniF0D2; E3CA
#   uniF0D3; E3CB
#   uniF0D4; E3CC
#   uniF0D5; E3CD
#   uniF0D6; E3CE
#   uniF0D7; E3CF
#   uniF0D8; E3D0
#   uniF0D9; E3D1
#   uniF0DA; E3D2
#   uniF0DB; E3D3
#   uniF0DC; E3D4
#   uniF0DD; E3D5
#   uniF0DE; E3D6
#   uniF0DF; E3D7
#   uniF0E0; E3D8
#   uniF0E1; E3D9
#   uniF0E2; E3DA
#   uniF0E3; E3DB
#   uniF0E4; E3DC
#   uniF0E5; E3DD
#   uniF0E6; E3DE
#   uniF0E7; E3DF
#   uniF0E8; E3E0
#   uniF0E9; E3E1
#   uniF0EA; E3E2
#   uniF0EB; E3E3


