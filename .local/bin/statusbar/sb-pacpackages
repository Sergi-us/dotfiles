#!/bin/sh
## 2025-01-09 SARBS

# Zeigt die Anzahl der aktualisierbaren Pakete f√ºr Pacman und YAY an.

# Damit dies funktioniert, muss ein `pacman -Sy`-Befehl regelm√§√üig als
# Cronjob im Hintergrund als root ausgef√ºhrt werden. Dieses Script liest dann diese Pakete.
# Bei einem Klick wird ein Upgrade via pacman durchgef√ºhrt.

case $BLOCK_BUTTON in
	1) setsid -f "$TERMINAL" -e sb-popupgrade ;; # Linksklick zum Upgraden
	2) notify-send "$(/usr/bin/pacman -Qu)" ;; # Mittelklick zeigt aktualisierbare Pakete
	3) notify-send "Û∞£á Upgrade-Modul" "Û∞£á: Anzahl der aktualisierbaren Pakete
- Linksklick, um Pakete zu aktualisieren
- Mittelklick, um aktualisierbare Pakete anzuzeigen" ;; # Rechtsklick f√ºr Hilfe
	6) setsid -f "$TERMINAL" -e "$EDITOR" "$0" ;; # Strg + Rechtsklick zum Bearbeiten
esac

pacman -Qu | grep -Fcv "[ignored]" | sed "s/^0$//g"

# Nur anzeigen wenn Updates verf√ºgbar sind
if [ "$updates" -gt 0 ]; then
	# Verschiedene M√∂glichkeiten - teste welche funktioniert:

	# Option 1: Nerd Font Symbol (funktioniert meist)
	echo "Û∞èñ $updates X"

	# Option 2: Falls Option 1 nicht klappt, probiere:
	# echo "üì¶ $updates"

	# Option 3: Einfaches ASCII-Symbol:
	# echo "[A] $updates"

	# Option 4: Hex-Darstellung (manchmal n√∂tig):
	# printf "\uE0A0 %s\n" "$updates"
fi
